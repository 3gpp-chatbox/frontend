{
  "procedure_name": "Registration procedure for initial registrati",
  "graph": {
    "nodes": [
      {
        "id": "UE_Deregistered",
        "type": "state",
        "description": "UE is in 5GMM-DEREGISTERED state, not registered with the network."
      },
      {
        "id": "UE_Attempting_Initial_Registration",
        "type": "state",
        "description": "UE has sent a REGISTRATION REQUEST for initial registration and is waiting for a response or performing common procedures (e.g., authentication, security)."
      },
      {
        "id": "UE_Authenticating_Securing",
        "type": "state",
        "description": "UE is actively involved in authentication or security mode control procedures initiated by the AMF."
      },
      {
        "id": "UE_Sending_RegComplete",
        "type": "state",
        "description": "UE has received a REGISTRATION ACCEPT requiring acknowledgment and is preparing to send the REGISTRATION COMPLETE message."
      },
      {
        "id": "UE_Registered",
        "type": "state",
        "description": "UE has successfully completed the initial registration procedure and is in 5GMM-REGISTERED state."
      },
      {
        "id": "UE_Retry_After_Rejection",
        "type": "state",
        "description": "UE received a REGISTRATION REJECT with a cause requiring a backoff period (T3346) before retrying registration."
      },
      {
        "id": "UE_Deregistered_PLMN_Search",
        "type": "state",
        "description": "UE received a REGISTRATION REJECT with a cause requiring PLMN/SNPN reselection."
      },
      {
        "id": "UE_Waiting_T3511",
        "type": "state",
        "description": "UE is waiting for timer T3511 to expire after a T3510 timeout before retrying registration (attempt < 5)."
      },
      {
        "id": "UE_Waiting_T3502",
        "type": "state",
        "description": "UE is waiting for timer T3502 to expire after reaching the maximum number of registration attempts (T3510 timeout, attempt = 5)."
      },
      {
        "id": "AMF_Idle",
        "type": "state",
        "description": "AMF is idle, not processing any registration procedure for this UE."
      },
      {
        "id": "AMF_Processing_Initial_Registration",
        "type": "state",
        "description": "AMF has received the REGISTRATION REQUEST and is processing it (e.g., context retrieval, initiating common procedures)."
      },
      {
        "id": "AMF_Authenticating_Securing",
        "type": "state",
        "description": "AMF is performing authentication or security mode control procedures with the UE."
      },
      {
        "id": "AMF_Waiting_Registration_Complete",
        "type": "state",
        "description": "AMF has sent REGISTRATION ACCEPT requiring acknowledgment and is waiting for the REGISTRATION COMPLETE message from the UE (timer T3550 running)."
      },
      {
        "id": "AMF_Registered",
        "type": "state",
        "description": "AMF considers the UE successfully registered (either after receiving REGISTRATION COMPLETE or sending REGISTRATION ACCEPT not requiring completion)."
      },
      {
        "id": "E_REGISTRATION_REQUEST",
        "type": "event",
        "description": "A REGISTRATION REQUEST message is sent by the UE or received by the AMF."
      },
      {
        "id": "E_AUTHENTICATION_REQUEST",
        "type": "event",
        "description": "An AUTHENTICATION REQUEST message is sent by the AMF or received by the UE."
      },
      {
        "id": "E_SECURITY_MODE_COMMAND",
        "type": "event",
        "description": "A SECURITY MODE COMMAND message is sent by the AMF or received by the UE."
      },
      {
        "id": "E_AUTHENTICATION_RESPONSE",
        "type": "event",
        "description": "An AUTHENTICATION RESPONSE message is sent by the UE or received by the AMF."
      },
      {
        "id": "E_SECURITY_MODE_COMPLETE",
        "type": "event",
        "description": "A SECURITY MODE COMPLETE message is sent by the UE or received by the AMF."
      },
      {
        "id": "E_REGISTRATION_ACCEPT_ReqComplete",
        "type": "event",
        "description": "A REGISTRATION ACCEPT message requiring a REGISTRATION COMPLETE response is sent by the AMF or received by the UE."
      },
      {
        "id": "E_REGISTRATION_ACCEPT_NoComplete",
        "type": "event",
        "description": "A REGISTRATION ACCEPT message not requiring a REGISTRATION COMPLETE response is sent by the AMF or received by the UE."
      },
      {
        "id": "E_REGISTRATION_REJECT",
        "type": "event",
        "description": "A REGISTRATION REJECT message is sent by the AMF or received by the UE."
      },
      {
        "id": "E_REGISTRATION_COMPLETE",
        "type": "event",
        "description": "A REGISTRATION COMPLETE message is sent by the UE or received by the AMF."
      },
      {
        "id": "E_T3510_Timeout_Retry",
        "type": "event",
        "description": "Timer T3510 expires at the UE, and the registration attempt counter is less than 5."
      },
      {
        "id": "E_T3510_Timeout_Max",
        "type": "event",
        "description": "Timer T3510 expires at the UE, and the registration attempt counter is equal to 5."
      },
      {
        "id": "E_T3511_Timeout",
        "type": "event",
        "description": "Timer T3511 expires at the UE."
      },
      {
        "id": "E_T3502_Timeout",
        "type": "event",
        "description": "Timer T3502 expires at the UE."
      },
      {
        "id": "E_T3346_Timeout",
        "type": "event",
        "description": "Timer T3346 expires at the UE."
      },
      {
        "id": "E_PLMN_Selection_Complete",
        "type": "event",
        "description": "The UE completes the PLMN/SNPN selection process."
      },
      {
        "id": "E_T3550_Timeout_Retry",
        "type": "event",
        "description": "Timer T3550 expires at the AMF, and the retransmission counter is less than 4."
      },
      {
        "id": "E_T3550_Timeout_Max",
        "type": "event",
        "description": "Timer T3550 expires at the AMF for the fifth time (max retransmissions)."
      },
      {
        "id": "E_Failure_UE",
        "type": "event",
        "description": "An abnormal case occurs at the UE side during registration (e.g., lower layer failure, transmission failure)."
      },
      {
        "id": "E_TAI_Changed",
        "type": "event",
        "description": "The UE's current TAI changes and is no longer in the TAI list received in REGISTRATION ACCEPT, potentially during a failure."
      },
      {
        "id": "E_Failure_AMF",
        "type": "event",
        "description": "An abnormal case occurs at the AMF side during registration (e.g., lower layer failure while waiting for REGISTRATION COMPLETE)."
      }
    ],
    "edges": [
      {
        "from": "UE_Deregistered",
        "to": "E_REGISTRATION_REQUEST",
        "type": "trigger",
        "description": "Triggered when the UE in 5GMM-DEREGISTERED state initiates initial registration by sending a REGISTRATION REQUEST message (Subclause 5.5.1.2.2)."
      },
      {
        "from": "E_REGISTRATION_REQUEST",
        "to": "UE_Attempting_Initial_Registration",
        "type": "condition",
        "description": "UE transitions to attempting registration after sending the REGISTRATION REQUEST and starting timer T3510 (Subclause 5.5.1.2.2)."
      },
      {
        "from": "AMF_Idle",
        "to": "E_REGISTRATION_REQUEST",
        "type": "trigger",
        "description": "Triggered when the AMF receives a REGISTRATION REQUEST message from the UE."
      },
      {
        "from": "E_REGISTRATION_REQUEST",
        "to": "AMF_Processing_Initial_Registration",
        "type": "condition",
        "description": "AMF transitions to processing the registration upon receiving the REGISTRATION REQUEST."
      },
      {
        "from": "AMF_Processing_Initial_Registration",
        "to": "AMF_Authenticating_Securing",
        "type": "trigger",
        "description": "Triggered when the AMF initiates 5GMM common procedures like authentication and security based on the REGISTRATION REQUEST (Subclause 5.5.1.2.3)."
      },
      {
        "from": "AMF_Authenticating_Securing",
        "to": "E_AUTHENTICATION_REQUEST",
        "type": "trigger",
        "description": "Triggered when the AMF sends an AUTHENTICATION REQUEST message to the UE as part of the authentication procedure (Subclause 5.5.1.2.3)."
      },
      {
        "from": "E_AUTHENTICATION_REQUEST",
        "to": "UE_Authenticating_Securing",
        "type": "condition",
        "description": "UE transitions to handle authentication/security upon receiving the AUTHENTICATION REQUEST."
      },
      {
        "from": "AMF_Authenticating_Securing",
        "to": "E_SECURITY_MODE_COMMAND",
        "type": "trigger",
        "description": "Triggered when the AMF sends a SECURITY MODE COMMAND message to the UE as part of the security procedure (Subclause 5.5.1.2.3)."
      },
      {
        "from": "E_SECURITY_MODE_COMMAND",
        "to": "UE_Authenticating_Securing",
        "type": "condition",
        "description": "UE transitions to handle authentication/security upon receiving the SECURITY MODE COMMAND."
      },
      {
        "from": "UE_Authenticating_Securing",
        "to": "E_AUTHENTICATION_RESPONSE",
        "type": "trigger",
        "description": "Triggered when the UE sends an AUTHENTICATION RESPONSE message to the AMF."
      },
      {
        "from": "E_AUTHENTICATION_RESPONSE",
        "to": "UE_Attempting_Initial_Registration",
        "type": "condition",
        "description": "UE returns to attempting registration after sending the AUTHENTICATION RESPONSE, awaiting further network action."
      },
      {
        "from": "UE_Authenticating_Securing",
        "to": "E_SECURITY_MODE_COMPLETE",
        "type": "trigger",
        "description": "Triggered when the UE sends a SECURITY MODE COMPLETE message to the AMF."
      },
      {
        "from": "E_SECURITY_MODE_COMPLETE",
        "to": "UE_Attempting_Initial_Registration",
        "type": "condition",
        "description": "UE returns to attempting registration after sending the SECURITY MODE COMPLETE, awaiting further network action."
      },
      {
        "from": "AMF_Authenticating_Securing",
        "to": "E_REGISTRATION_ACCEPT_ReqComplete",
        "type": "trigger",
        "description": "Triggered when the AMF accepts the registration and sends REGISTRATION ACCEPT requiring a REGISTRATION COMPLETE response (e.g., due to GUTI reallocation, SOR, ODB, CAG list update, PEIPS, UE Radio Cap ID, Truncated S-TMSI config, UUAA pending, NSSAI update, NSAG info, Alternative NSSAI, On-demand NSSAI) (Subclause 5.5.1.2.4)."
      },
      {
        "from": "E_REGISTRATION_ACCEPT_ReqComplete",
        "to": "AMF_Waiting_Registration_Complete",
        "type": "condition",
        "description": "AMF transitions to waiting for REGISTRATION COMPLETE after sending REGISTRATION ACCEPT requiring completion, starting timer T3550 (Subclause 5.5.1.2.4)."
      },
      {
        "from": "AMF_Authenticating_Securing",
        "to": "E_REGISTRATION_ACCEPT_NoComplete",
        "type": "trigger",
        "description": "Triggered when the AMF accepts the registration and sends REGISTRATION ACCEPT not requiring a REGISTRATION COMPLETE response (Subclause 5.5.1.2.4)."
      },
      {
        "from": "E_REGISTRATION_ACCEPT_NoComplete",
        "to": "AMF_Registered",
        "type": "condition",
        "description": "AMF transitions to registered state after sending REGISTRATION ACCEPT that does not require completion."
      },
      {
        "from": "AMF_Authenticating_Securing",
        "to": "E_REGISTRATION_REJECT",
        "type": "trigger",
        "description": "Triggered when the AMF rejects the registration request and sends a REGISTRATION REJECT message (Subclause 5.5.1.2.5)."
      },
      {
        "from": "E_REGISTRATION_REJECT",
        "to": "AMF_Idle",
        "type": "condition",
        "description": "AMF returns to idle state after sending REGISTRATION REJECT."
      },
      {
        "from": "UE_Attempting_Initial_Registration",
        "to": "E_REGISTRATION_ACCEPT_ReqComplete",
        "type": "trigger",
        "description": "Triggered when the UE receives a REGISTRATION ACCEPT message that requires a REGISTRATION COMPLETE response (e.g., due to GUTI, SOR, ODB, CAG list, PEIPS, UE Radio Cap ID, Truncated S-TMSI config, UUAA pending, NSSAI update, NSAG info, Alternative NSSAI, On-demand NSSAI) (Subclause 5.5.1.2.4)."
      },
      {
        "from": "E_REGISTRATION_ACCEPT_ReqComplete",
        "to": "UE_Sending_RegComplete",
        "type": "condition",
        "description": "UE transitions to sending REGISTRATION COMPLETE upon receiving a REGISTRATION ACCEPT that requires completion (Subclause 5.5.1.2.4)."
      },
      {
        "from": "UE_Attempting_Initial_Registration",
        "to": "E_REGISTRATION_ACCEPT_NoComplete",
        "type": "trigger",
        "description": "Triggered when the UE receives a REGISTRATION ACCEPT message that does not require a REGISTRATION COMPLETE response (Subclause 5.5.1.2.4)."
      },
      {
        "from": "E_REGISTRATION_ACCEPT_NoComplete",
        "to": "UE_Registered",
        "type": "condition",
        "description": "UE transitions to 5GMM-REGISTERED state upon receiving a REGISTRATION ACCEPT that does not require completion (Subclause 5.5.1.2.4)."
      },
      {
        "from": "UE_Attempting_Initial_Registration",
        "to": "E_REGISTRATION_REJECT",
        "type": "trigger",
        "description": "Triggered when the UE receives a REGISTRATION REJECT message from the AMF (Subclause 5.5.1.2.5)."
      },
      {
        "from": "E_REGISTRATION_REJECT",
        "to": "UE_Retry_After_Rejection",
        "type": "condition",
        "description": "UE transitions to retry state upon receiving REGISTRATION REJECT with 5GMM cause #22 (Congestion) and a valid T3346 value (Subclause 5.5.1.2.5)."
      },
      {
        "from": "E_REGISTRATION_REJECT",
        "to": "UE_Deregistered_PLMN_Search",
        "type": "condition",
        "description": "UE transitions to PLMN search state upon receiving REGISTRATION REJECT with specific causes requiring PLMN/SNPN reselection (e.g., #11, #73, #74, #75, #76, #78, #80) (Subclause 5.5.1.2.5)."
      },
      {
        "from": "E_REGISTRATION_REJECT",
        "to": "UE_Deregistered",
        "type": "condition",
        "description": "UE transitions to a deregistered sub-state (e.g., DEREGISTERED.NO-SUPI, DEREGISTERED.LIMITED-SERVICE, DEREGISTERED.ATTEMPTING-REGISTRATION) upon receiving REGISTRATION REJECT with causes not leading to immediate retry or PLMN search (e.g., #3, #6, #7, #10, #12, #13, #15, #27, #31, #62, #72, #77, #79, #81, #82) (Subclause 5.5.1.2.5)."
      },
      {
        "from": "UE_Retry_After_Rejection",
        "to": "E_T3346_Timeout",
        "type": "trigger",
        "description": "Triggered when the backoff timer T3346 expires (Subclause 5.5.1.2.5, Cause #22)."
      },
      {
        "from": "E_T3346_Timeout",
        "to": "UE_Deregistered",
        "type": "condition",
        "description": "UE returns to deregistered state to potentially re-initiate registration after T3346 expires (Subclause 5.5.1.2.5, Cause #22)."
      },
      {
        "from": "UE_Deregistered_PLMN_Search",
        "to": "E_PLMN_Selection_Complete",
        "type": "trigger",
        "description": "Triggered when the UE completes the PLMN/SNPN selection process according to 3GPP TS 23.122 [5]."
      },
      {
        "from": "E_PLMN_Selection_Complete",
        "to": "UE_Deregistered",
        "type": "condition",
        "description": "UE returns to deregistered state on the newly selected PLMN/SNPN, ready to initiate registration."
      },
      {
        "from": "UE_Sending_RegComplete",
        "to": "E_REGISTRATION_COMPLETE",
        "type": "trigger",
        "description": "Triggered when the UE sends the REGISTRATION COMPLETE message to the AMF (Subclause 5.5.1.2.4)."
      },
      {
        "from": "E_REGISTRATION_COMPLETE",
        "to": "UE_Registered",
        "type": "condition",
        "description": "UE transitions to 5GMM-REGISTERED state after sending the REGISTRATION COMPLETE message."
      },
      {
        "from": "AMF_Waiting_Registration_Complete",
        "to": "E_REGISTRATION_COMPLETE",
        "type": "trigger",
        "description": "Triggered when the AMF receives the REGISTRATION COMPLETE message from the UE (Subclause 5.5.1.2.4)."
      },
      {
        "from": "E_REGISTRATION_COMPLETE",
        "to": "AMF_Registered",
        "type": "condition",
        "description": "AMF transitions to 5GMM-REGISTERED state upon receiving the REGISTRATION COMPLETE message, stopping timer T3550 (Subclause 5.5.1.2.4)."
      },
      {
        "from": "UE_Attempting_Initial_Registration",
        "to": "E_T3510_Timeout_Retry",
        "type": "trigger",
        "description": "Triggered upon T3510 timeout when the registration attempt counter is less than 5 (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "E_T3510_Timeout_Retry",
        "to": "UE_Waiting_T3511",
        "type": "condition",
        "description": "UE transitions to waiting for T3511 after T3510 timeout (retry case), starting timer T3511 (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "UE_Waiting_T3511",
        "to": "E_T3511_Timeout",
        "type": "trigger",
        "description": "Triggered when timer T3511 expires (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "E_T3511_Timeout",
        "to": "UE_Deregistered",
        "type": "condition",
        "description": "UE returns to deregistered state to restart registration after T3511 expires (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "UE_Attempting_Initial_Registration",
        "to": "E_T3510_Timeout_Max",
        "type": "trigger",
        "description": "Triggered upon T3510 timeout when the registration attempt counter reaches 5 (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "E_T3510_Timeout_Max",
        "to": "UE_Waiting_T3502",
        "type": "condition",
        "description": "UE transitions to waiting for T3502 after T3510 timeout (max attempts reached), starting timer T3502 (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "UE_Waiting_T3502",
        "to": "E_T3502_Timeout",
        "type": "trigger",
        "description": "Triggered when timer T3502 expires (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "E_T3502_Timeout",
        "to": "UE_Deregistered",
        "type": "condition",
        "description": "UE returns to deregistered state (potentially initiating PLMN search) after T3502 expires (Subclause 5.5.1.2.7 case c)."
      },
      {
        "from": "UE_Attempting_Initial_Registration",
        "to": "E_Failure_UE",
        "type": "trigger",
        "description": "Triggered by various UE-side failures like lower layer issues, transmission failures, or other abnormal cases during the attempt (Subclause 5.5.1.2.7 cases e, k, n)."
      },
      {
        "from": "E_Failure_UE",
        "to": "UE_Deregistered",
        "type": "condition",
        "description": "UE transitions back to a deregistered state following a failure during the registration attempt, potentially after incrementing attempt counter (Subclause 5.5.1.2.7 cases c, d, e)."
      },
      {
        "from": "UE_Sending_RegComplete",
        "to": "E_Failure_UE",
        "type": "trigger",
        "description": "Triggered by transmission failure of the REGISTRATION COMPLETE message (Subclause 5.5.1.2.7 case j)."
      },
      {
        "from": "E_Failure_UE",
        "to": "UE_Sending_RegComplete",
        "type": "condition",
        "description": "UE may return to the state of sending REGISTRATION COMPLETE to retry transmission after failure (implementation specific) (Subclause 5.5.1.2.7 case j)."
      },
      {
        "from": "E_Failure_UE",
        "to": "E_TAI_Changed",
        "type": "condition",
        "description": "Condition where failure to send REGISTRATION COMPLETE coincides with TAI changing out of the assigned list (Subclause 5.5.1.2.7 case i)."
      },
      {
        "from": "E_TAI_Changed",
        "to": "UE_Deregistered",
        "type": "condition",
        "description": "UE aborts initial registration and transitions towards deregistered state to initiate mobility registration update due to TAI change during REG COMPLETE failure (Subclause 5.5.1.2.7 case i)."
      },
      {
        "from": "AMF_Waiting_Registration_Complete",
        "to": "E_T3550_Timeout_Retry",
        "type": "trigger",
        "description": "Triggered upon T3550 timeout when the retransmission counter is less than 4 (Subclause 5.5.1.2.8 case c)."
      },
      {
        "from": "E_T3550_Timeout_Retry",
        "to": "AMF_Waiting_Registration_Complete",
        "type": "condition",
        "description": "AMF retransmits REGISTRATION ACCEPT, restarts T3550, and remains in the waiting state (Subclause 5.5.1.2.8 case c)."
      },
      {
        "from": "AMF_Waiting_Registration_Complete",
        "to": "E_T3550_Timeout_Max",
        "type": "trigger",
        "description": "Triggered upon the fifth expiry of timer T3550 (max retransmissions reached) (Subclause 5.5.1.2.8 case c)."
      },
      {
        "from": "E_T3550_Timeout_Max",
        "to": "AMF_Registered",
        "type": "condition",
        "description": "AMF aborts waiting for REGISTRATION COMPLETE and transitions to registered state after T3550 max timeouts (Subclause 5.5.1.2.8 case c)."
      },
      {
        "from": "AMF_Waiting_Registration_Complete",
        "to": "E_Failure_AMF",
        "type": "trigger",
        "description": "Triggered by AMF-side failures (e.g., lower layer failure) while waiting for REGISTRATION COMPLETE (Subclause 5.5.1.2.8 case a)."
      },
      {
        "from": "E_Failure_AMF",
        "to": "AMF_Registered",
        "type": "condition",
        "description": "AMF aborts waiting for REGISTRATION COMPLETE and transitions to registered state following a failure (Subclause 5.5.1.2.8 case a)."
      }
    ]
  }
}
